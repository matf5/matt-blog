<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Rust é”™è¯¯å¤„ç† | mattçš„å‰ç«¯ä¹‹è·¯</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/matt-blog/cainiao.jpg">
    <meta name="description" content="mattçš„å‰ç«¯ä¹‹è·¯">
    
    <link rel="preload" href="/matt-blog/assets/css/0.styles.67df34d8.css" as="style"><link rel="preload" href="/matt-blog/assets/js/app.2eaa7660.js" as="script"><link rel="preload" href="/matt-blog/assets/js/2.778bb4ad.js" as="script"><link rel="preload" href="/matt-blog/assets/js/1.f8bb34da.js" as="script"><link rel="preload" href="/matt-blog/assets/js/43.10b4130b.js" as="script"><link rel="prefetch" href="/matt-blog/assets/js/10.fde088a2.js"><link rel="prefetch" href="/matt-blog/assets/js/11.c62b6b34.js"><link rel="prefetch" href="/matt-blog/assets/js/12.27d4f152.js"><link rel="prefetch" href="/matt-blog/assets/js/13.3f3f6a36.js"><link rel="prefetch" href="/matt-blog/assets/js/14.eb7a3d07.js"><link rel="prefetch" href="/matt-blog/assets/js/15.114dfd5c.js"><link rel="prefetch" href="/matt-blog/assets/js/16.85253907.js"><link rel="prefetch" href="/matt-blog/assets/js/17.c2838453.js"><link rel="prefetch" href="/matt-blog/assets/js/18.3256f17f.js"><link rel="prefetch" href="/matt-blog/assets/js/19.d8afd0ae.js"><link rel="prefetch" href="/matt-blog/assets/js/20.0d880388.js"><link rel="prefetch" href="/matt-blog/assets/js/21.33b300c9.js"><link rel="prefetch" href="/matt-blog/assets/js/22.b7c97fbe.js"><link rel="prefetch" href="/matt-blog/assets/js/23.4db98f57.js"><link rel="prefetch" href="/matt-blog/assets/js/24.f1640500.js"><link rel="prefetch" href="/matt-blog/assets/js/25.2773990a.js"><link rel="prefetch" href="/matt-blog/assets/js/26.3f9a83a0.js"><link rel="prefetch" href="/matt-blog/assets/js/27.9a298227.js"><link rel="prefetch" href="/matt-blog/assets/js/28.e2a66828.js"><link rel="prefetch" href="/matt-blog/assets/js/29.97d11acd.js"><link rel="prefetch" href="/matt-blog/assets/js/3.af33e5d6.js"><link rel="prefetch" href="/matt-blog/assets/js/30.22bee9f6.js"><link rel="prefetch" href="/matt-blog/assets/js/31.1d76566f.js"><link rel="prefetch" href="/matt-blog/assets/js/32.4a0440ac.js"><link rel="prefetch" href="/matt-blog/assets/js/33.37b462a8.js"><link rel="prefetch" href="/matt-blog/assets/js/34.88ebc733.js"><link rel="prefetch" href="/matt-blog/assets/js/35.eff53b64.js"><link rel="prefetch" href="/matt-blog/assets/js/36.82f9ebe4.js"><link rel="prefetch" href="/matt-blog/assets/js/37.159089ca.js"><link rel="prefetch" href="/matt-blog/assets/js/38.7b02d561.js"><link rel="prefetch" href="/matt-blog/assets/js/39.aad63f87.js"><link rel="prefetch" href="/matt-blog/assets/js/4.45665f8a.js"><link rel="prefetch" href="/matt-blog/assets/js/40.b7168191.js"><link rel="prefetch" href="/matt-blog/assets/js/41.0df1c711.js"><link rel="prefetch" href="/matt-blog/assets/js/42.edc6c793.js"><link rel="prefetch" href="/matt-blog/assets/js/44.301e1f95.js"><link rel="prefetch" href="/matt-blog/assets/js/45.b2583536.js"><link rel="prefetch" href="/matt-blog/assets/js/46.53181746.js"><link rel="prefetch" href="/matt-blog/assets/js/47.fdee3dd3.js"><link rel="prefetch" href="/matt-blog/assets/js/48.69af6e5b.js"><link rel="prefetch" href="/matt-blog/assets/js/49.2974f0ce.js"><link rel="prefetch" href="/matt-blog/assets/js/5.7098d77a.js"><link rel="prefetch" href="/matt-blog/assets/js/50.f197b11d.js"><link rel="prefetch" href="/matt-blog/assets/js/51.129ab8d5.js"><link rel="prefetch" href="/matt-blog/assets/js/52.39fbb785.js"><link rel="prefetch" href="/matt-blog/assets/js/53.497a8b17.js"><link rel="prefetch" href="/matt-blog/assets/js/54.6154a915.js"><link rel="prefetch" href="/matt-blog/assets/js/55.783c32bb.js"><link rel="prefetch" href="/matt-blog/assets/js/6.0c0a0f39.js"><link rel="prefetch" href="/matt-blog/assets/js/7.6a854e57.js"><link rel="prefetch" href="/matt-blog/assets/js/vendors~docsearch.5e19b665.js">
    <link rel="stylesheet" href="/matt-blog/assets/css/0.styles.67df34d8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/matt-blog/" class="home-link router-link-active"><img src="/matt-blog/cainiao.jpg" alt="mattçš„å‰ç«¯ä¹‹è·¯" class="logo"> <span class="site-name can-hide">mattçš„å‰ç«¯ä¹‹è·¯</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>hybrid</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>mini-program</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>è®¡ç®—æœºç½‘ç»œ</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>performance</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>é¡¹ç›®ç»éªŒå‰–æ</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>qwik</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>react</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>react-native</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>rust</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/matt-blog/pages/rust/" aria-current="page" class="sidebar-link">Rust å­¦ä¹ ä¹‹è·¯</a></li><li><a href="/matt-blog/pages/rust/basic-syntax.html" class="sidebar-link">Rust åŸºç¡€è¯­æ³•</a></li><li><a href="/matt-blog/pages/rust/collections.html" class="sidebar-link">é›†åˆç±»å‹</a></li><li><a href="/matt-blog/pages/rust/data-structures.html" class="sidebar-link">æ•°æ®ç»“æ„</a></li><li><a href="/matt-blog/pages/rust/error-handling.html" aria-current="page" class="active sidebar-link">é”™è¯¯å¤„ç†</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/matt-blog/pages/rust/error-handling.html#ğŸ“‹-æœ¬ç« å†…å®¹" class="sidebar-link">ğŸ“‹ æœ¬ç« å†…å®¹</a></li><li class="sidebar-sub-header"><a href="/matt-blog/pages/rust/error-handling.html#ä¸å¯æ¢å¤çš„é”™è¯¯ä¸-panic" class="sidebar-link">ä¸å¯æ¢å¤çš„é”™è¯¯ä¸ panic!</a></li><li class="sidebar-sub-header"><a href="/matt-blog/pages/rust/error-handling.html#å¯æ¢å¤çš„é”™è¯¯ä¸-result" class="sidebar-link">å¯æ¢å¤çš„é”™è¯¯ä¸ Result</a></li><li class="sidebar-sub-header"><a href="/matt-blog/pages/rust/error-handling.html#å¤±è´¥æ—¶-panic-çš„ç®€å†™-unwrap-å’Œ-expect" class="sidebar-link">å¤±è´¥æ—¶ panic çš„ç®€å†™ï¼šunwrap å’Œ expect</a></li><li class="sidebar-sub-header"><a href="/matt-blog/pages/rust/error-handling.html#ä¼ æ’­é”™è¯¯" class="sidebar-link">ä¼ æ’­é”™è¯¯</a></li><li class="sidebar-sub-header"><a href="/matt-blog/pages/rust/error-handling.html#ä½•æ—¶ä½¿ç”¨-panic" class="sidebar-link">ä½•æ—¶ä½¿ç”¨ panic!</a></li><li class="sidebar-sub-header"><a href="/matt-blog/pages/rust/error-handling.html#åˆ›å»ºè‡ªå®šä¹‰é”™è¯¯ç±»å‹" class="sidebar-link">åˆ›å»ºè‡ªå®šä¹‰é”™è¯¯ç±»å‹</a></li><li class="sidebar-sub-header"><a href="/matt-blog/pages/rust/error-handling.html#ä½¿ç”¨-anyhow-å’Œ-thiserror" class="sidebar-link">ä½¿ç”¨ anyhow å’Œ thiserror</a></li><li class="sidebar-sub-header"><a href="/matt-blog/pages/rust/error-handling.html#ğŸ’¡-å…³é”®è¦ç‚¹" class="sidebar-link">ğŸ’¡ å…³é”®è¦ç‚¹</a></li><li class="sidebar-sub-header"><a href="/matt-blog/pages/rust/error-handling.html#ğŸ¯-å®è·µå»ºè®®" class="sidebar-link">ğŸ¯ å®è·µå»ºè®®</a></li><li class="sidebar-sub-header"><a href="/matt-blog/pages/rust/error-handling.html#ğŸ”—-ç›¸å…³é“¾æ¥" class="sidebar-link">ğŸ”— ç›¸å…³é“¾æ¥</a></li></ul></li><li><a href="/matt-blog/pages/rust/functional-programming.html" class="sidebar-link">å‡½æ•°å¼ç¼–ç¨‹</a></li><li><a href="/matt-blog/pages/rust/generics-and-traits.html" class="sidebar-link">æ³›å‹ä¸ç‰¹å¾</a></li><li><a href="/matt-blog/pages/rust/ownership.html" class="sidebar-link">æ‰€æœ‰æƒç³»ç»Ÿ</a></li><li><a href="/matt-blog/pages/rust/smart-pointers.html" class="sidebar-link">æ™ºèƒ½æŒ‡é’ˆ</a></li><li><a href="/matt-blog/pages/rust/tools-and-project.html" class="sidebar-link">å·¥å…·ä¸é¡¹ç›®ç®¡ç†</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>vueå­¦ä¹ </span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>webpackå­¦ä¹ </span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>xiaochengxu</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="rust-é”™è¯¯å¤„ç†"><a href="#rust-é”™è¯¯å¤„ç†" class="header-anchor">#</a> Rust é”™è¯¯å¤„ç†</h1> <p>Rust å°†é”™è¯¯ç»„åˆæˆä¸¤ä¸ªä¸»è¦ç±»åˆ«ï¼š<strong>å¯æ¢å¤çš„</strong>ï¼ˆrecoverableï¼‰å’Œ<strong>ä¸å¯æ¢å¤çš„</strong>ï¼ˆunrecoverableï¼‰é”™è¯¯ã€‚</p> <h2 id="ğŸ“‹-æœ¬ç« å†…å®¹"><a href="#ğŸ“‹-æœ¬ç« å†…å®¹" class="header-anchor">#</a> ğŸ“‹ æœ¬ç« å†…å®¹</h2> <ul><li><a href="#%E4%B8%8D%E5%8F%AF%E6%81%A2%E5%A4%8D%E7%9A%84%E9%94%99%E8%AF%AF%E4%B8%8E-panic">ä¸å¯æ¢å¤çš„é”™è¯¯ä¸ panic!</a></li> <li><a href="#%E5%8F%AF%E6%81%A2%E5%A4%8D%E7%9A%84%E9%94%99%E8%AF%AF%E4%B8%8E-result">å¯æ¢å¤çš„é”™è¯¯ä¸ Result</a></li> <li><a href="#%E4%BC%A0%E6%92%AD%E9%94%99%E8%AF%AF">ä¼ æ’­é”™è¯¯</a></li> <li><a href="#%E4%BD%95%E6%97%B6%E4%BD%BF%E7%94%A8-panic">ä½•æ—¶ä½¿ç”¨ panic!</a></li></ul> <h2 id="ä¸å¯æ¢å¤çš„é”™è¯¯ä¸-panic"><a href="#ä¸å¯æ¢å¤çš„é”™è¯¯ä¸-panic" class="header-anchor">#</a> ä¸å¯æ¢å¤çš„é”™è¯¯ä¸ panic!</h2> <p>æœ‰äº›æ—¶å€™ä»£ç å‡ºé—®é¢˜äº†ï¼Œè€Œä½ å¯¹æ­¤æŸæ‰‹æ— ç­–ã€‚å¯¹äºè¿™ç§æƒ…å†µï¼ŒRust æœ‰ <code>panic!</code> å®ã€‚å½“æ‰§è¡Œè¿™ä¸ªå®æ—¶ï¼Œç¨‹åºä¼šæ‰“å°å‡ºä¸€ä¸ªé”™è¯¯ä¿¡æ¯ï¼Œå±•å¼€å¹¶æ¸…ç†æ ˆæ•°æ®ï¼Œç„¶åæ¥ç€é€€å‡ºã€‚</p> <h3 id="ä½¿ç”¨-panic"><a href="#ä½¿ç”¨-panic" class="header-anchor">#</a> ä½¿ç”¨ panic!</h3> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">panic!</span><span class="token punctuation">(</span><span class="token string">&quot;crash and burn&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="æ•°ç»„è¶Šç•Œå¼•èµ·çš„-panic"><a href="#æ•°ç»„è¶Šç•Œå¼•èµ·çš„-panic" class="header-anchor">#</a> æ•°ç»„è¶Šç•Œå¼•èµ·çš„ panic!</h3> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> v <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    v<span class="token punctuation">[</span><span class="token number">99</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// è¿™ä¼šå¯¼è‡´ panic!</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="è®¾ç½®-panic-çš„è¡Œä¸º"><a href="#è®¾ç½®-panic-çš„è¡Œä¸º" class="header-anchor">#</a> è®¾ç½® panic! çš„è¡Œä¸º</h3> <p>åœ¨ <code>Cargo.toml</code> ä¸­è®¾ç½®ï¼š</p> <div class="language-toml extra-class"><pre class="language-toml"><code><span class="token punctuation">[</span><span class="token table class-name">profile.release</span><span class="token punctuation">]</span>
<span class="token key property">panic</span> <span class="token punctuation">=</span> <span class="token string">'abort'</span>
</code></pre></div><h2 id="å¯æ¢å¤çš„é”™è¯¯ä¸-result"><a href="#å¯æ¢å¤çš„é”™è¯¯ä¸-result" class="header-anchor">#</a> å¯æ¢å¤çš„é”™è¯¯ä¸ Result</h2> <p>å¤§éƒ¨åˆ†é”™è¯¯å¹¶æ²¡æœ‰ä¸¥é‡åˆ°éœ€è¦ç¨‹åºå®Œå…¨åœæ­¢æ‰§è¡Œã€‚æœ‰äº›æ—¶å€™ï¼Œä¸€ä¸ªå‡½æ•°å¤±è´¥æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°è§£é‡Šå’Œå“åº”è¿™ä¸ªé”™è¯¯ã€‚</p> <h3 id="result-æšä¸¾"><a href="#result-æšä¸¾" class="header-anchor">#</a> Result æšä¸¾</h3> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">enum</span> <span class="token type-definition class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">E</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token class-name">Ok</span><span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token class-name">E</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="å¤„ç†-result"><a href="#å¤„ç†-result" class="header-anchor">#</a> å¤„ç† Result</h3> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span></span><span class="token class-name">File</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> f <span class="token operator">=</span> <span class="token class-name">File</span><span class="token punctuation">::</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;hello.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> f <span class="token operator">=</span> <span class="token keyword">match</span> f <span class="token punctuation">{</span>
        <span class="token class-name">Ok</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> file<span class="token punctuation">,</span>
        <span class="token class-name">Err</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token macro property">panic!</span><span class="token punctuation">(</span><span class="token string">&quot;Problem opening the file: {:?}&quot;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="åŒ¹é…ä¸åŒçš„é”™è¯¯"><a href="#åŒ¹é…ä¸åŒçš„é”™è¯¯" class="header-anchor">#</a> åŒ¹é…ä¸åŒçš„é”™è¯¯</h3> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span></span><span class="token class-name">File</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token class-name">ErrorKind</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> f <span class="token operator">=</span> <span class="token class-name">File</span><span class="token punctuation">::</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;hello.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> f <span class="token operator">=</span> <span class="token keyword">match</span> f <span class="token punctuation">{</span>
        <span class="token class-name">Ok</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> file<span class="token punctuation">,</span>
        <span class="token class-name">Err</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">match</span> error<span class="token punctuation">.</span><span class="token function">kind</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">ErrorKind</span><span class="token punctuation">::</span><span class="token class-name">NotFound</span> <span class="token operator">=&gt;</span> <span class="token keyword">match</span> <span class="token class-name">File</span><span class="token punctuation">::</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">&quot;hello.txt&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">Ok</span><span class="token punctuation">(</span>fc<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> fc<span class="token punctuation">,</span>
                <span class="token class-name">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token macro property">panic!</span><span class="token punctuation">(</span><span class="token string">&quot;Problem creating the file: {:?}&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            other_error <span class="token operator">=&gt;</span> <span class="token macro property">panic!</span><span class="token punctuation">(</span><span class="token string">&quot;Problem opening the file: {:?}&quot;</span><span class="token punctuation">,</span> other_error<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="ä½¿ç”¨é—­åŒ…ç®€åŒ–é”™è¯¯å¤„ç†"><a href="#ä½¿ç”¨é—­åŒ…ç®€åŒ–é”™è¯¯å¤„ç†" class="header-anchor">#</a> ä½¿ç”¨é—­åŒ…ç®€åŒ–é”™è¯¯å¤„ç†</h3> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span></span><span class="token class-name">File</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token class-name">ErrorKind</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> f <span class="token operator">=</span> <span class="token class-name">File</span><span class="token punctuation">::</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;hello.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap_or_else</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>error<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> error<span class="token punctuation">.</span><span class="token function">kind</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">ErrorKind</span><span class="token punctuation">::</span><span class="token class-name">NotFound</span> <span class="token punctuation">{</span>
            <span class="token class-name">File</span><span class="token punctuation">::</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">&quot;hello.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap_or_else</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>error<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
                <span class="token macro property">panic!</span><span class="token punctuation">(</span><span class="token string">&quot;Problem creating the file: {:?}&quot;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token macro property">panic!</span><span class="token punctuation">(</span><span class="token string">&quot;Problem opening the file: {:?}&quot;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="å¤±è´¥æ—¶-panic-çš„ç®€å†™-unwrap-å’Œ-expect"><a href="#å¤±è´¥æ—¶-panic-çš„ç®€å†™-unwrap-å’Œ-expect" class="header-anchor">#</a> å¤±è´¥æ—¶ panic çš„ç®€å†™ï¼šunwrap å’Œ expect</h2> <h3 id="unwrap"><a href="#unwrap" class="header-anchor">#</a> unwrap</h3> <p><code>unwrap</code> æ˜¯ <code>match</code> è¯­å¥çš„ä¸€ä¸ªå¿«æ·æ–¹æ³•ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span></span><span class="token class-name">File</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> f <span class="token operator">=</span> <span class="token class-name">File</span><span class="token punctuation">::</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;hello.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="expect"><a href="#expect" class="header-anchor">#</a> expect</h3> <p><code>expect</code> ä¸ <code>unwrap</code> ç±»ä¼¼ï¼Œä½†å…è®¸æˆ‘ä»¬é€‰æ‹© <code>panic!</code> çš„é”™è¯¯ä¿¡æ¯ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span></span><span class="token class-name">File</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> f <span class="token operator">=</span> <span class="token class-name">File</span><span class="token punctuation">::</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;hello.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to open hello.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="ä¼ æ’­é”™è¯¯"><a href="#ä¼ æ’­é”™è¯¯" class="header-anchor">#</a> ä¼ æ’­é”™è¯¯</h2> <p>å½“ç¼–å†™ä¸€ä¸ªå…¶å®ç°ä¼šè°ƒç”¨ä¸€äº›å¯èƒ½ä¼šå¤±è´¥çš„æ“ä½œçš„å‡½æ•°æ—¶ï¼Œé™¤äº†åœ¨è¿™ä¸ªå‡½æ•°ä¸­å¤„ç†é”™è¯¯å¤–ï¼Œè¿˜å¯ä»¥é€‰æ‹©è®©è°ƒç”¨è€…çŸ¥é“è¿™ä¸ªé”™è¯¯å¹¶å†³å®šå¦‚ä½•å¤„ç†ã€‚</p> <h3 id="ä¼ æ’­é”™è¯¯çš„å®Œæ•´å†™æ³•"><a href="#ä¼ æ’­é”™è¯¯çš„å®Œæ•´å†™æ³•" class="header-anchor">#</a> ä¼ æ’­é”™è¯¯çš„å®Œæ•´å†™æ³•</h3> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>io<span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token class-name">Read</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span></span><span class="token class-name">File</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">read_username_from_file</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token namespace">io<span class="token punctuation">::</span></span><span class="token class-name">Error</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> f <span class="token operator">=</span> <span class="token class-name">File</span><span class="token punctuation">::</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;hello.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> f <span class="token operator">=</span> <span class="token keyword">match</span> f <span class="token punctuation">{</span>
        <span class="token class-name">Ok</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> file<span class="token punctuation">,</span>
        <span class="token class-name">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">return</span> <span class="token class-name">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">match</span> f<span class="token punctuation">.</span><span class="token function">read_to_string</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> s<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Ok</span><span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token class-name">Ok</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token class-name">Err</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="ä¼ æ’­é”™è¯¯çš„ç®€å†™-è¿ç®—ç¬¦"><a href="#ä¼ æ’­é”™è¯¯çš„ç®€å†™-è¿ç®—ç¬¦" class="header-anchor">#</a> ä¼ æ’­é”™è¯¯çš„ç®€å†™ï¼š? è¿ç®—ç¬¦</h3> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>io<span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token class-name">Read</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span></span><span class="token class-name">File</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">read_username_from_file</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token namespace">io<span class="token punctuation">::</span></span><span class="token class-name">Error</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> f <span class="token operator">=</span> <span class="token class-name">File</span><span class="token punctuation">::</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;hello.txt&quot;</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    f<span class="token punctuation">.</span><span class="token function">read_to_string</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> s<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
    <span class="token class-name">Ok</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="é“¾å¼è°ƒç”¨"><a href="#é“¾å¼è°ƒç”¨" class="header-anchor">#</a> é“¾å¼è°ƒç”¨</h3> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>io<span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token class-name">Read</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span></span><span class="token class-name">File</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">read_username_from_file</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token namespace">io<span class="token punctuation">::</span></span><span class="token class-name">Error</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token class-name">File</span><span class="token punctuation">::</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">&quot;hello.txt&quot;</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">read_to_string</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> s<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
    
    <span class="token class-name">Ok</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="æ›´ç®€æ´çš„å†™æ³•"><a href="#æ›´ç®€æ´çš„å†™æ³•" class="header-anchor">#</a> æ›´ç®€æ´çš„å†™æ³•</h3> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>io<span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>fs<span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">read_username_from_file</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token namespace">io<span class="token punctuation">::</span></span><span class="token class-name">Error</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token namespace">fs<span class="token punctuation">::</span></span><span class="token function">read_to_string</span><span class="token punctuation">(</span><span class="token string">&quot;hello.txt&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="è¿ç®—ç¬¦çš„å·¥ä½œåŸç†"><a href="#è¿ç®—ç¬¦çš„å·¥ä½œåŸç†" class="header-anchor">#</a> ? è¿ç®—ç¬¦çš„å·¥ä½œåŸç†</h3> <p><code>?</code> è¿ç®—ç¬¦è¿›è¡Œäº†ä¸ <code>match</code> è¡¨è¾¾å¼ç›¸åŒçš„å·¥ä½œï¼š</p> <ul><li>å¦‚æœ <code>Result</code> çš„å€¼æ˜¯ <code>Ok</code>ï¼Œè¿™ä¸ªè¡¨è¾¾å¼å°†ä¼šè¿”å› <code>Ok</code> ä¸­çš„å€¼</li> <li>å¦‚æœå€¼æ˜¯ <code>Err</code>ï¼Œ<code>Err</code> å°†ä½œä¸ºæ•´ä¸ªå‡½æ•°çš„è¿”å›å€¼</li></ul> <h3 id="è¿ç®—ç¬¦ä¸-from-å‡½æ•°"><a href="#è¿ç®—ç¬¦ä¸-from-å‡½æ•°" class="header-anchor">#</a> ? è¿ç®—ç¬¦ä¸ from å‡½æ•°</h3> <p><code>?</code> è¿ç®—ç¬¦ä¼šè‡ªåŠ¨è°ƒç”¨ <code>from</code> å‡½æ•°æ¥è½¬æ¢é”™è¯¯ç±»å‹ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span>io<span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>num<span class="token punctuation">::</span></span><span class="token class-name">ParseIntError</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">read_and_parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token punctuation">,</span> <span class="token class-name">ParseIntError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token namespace">std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span></span><span class="token function">read_to_string</span><span class="token punctuation">(</span><span class="token string">&quot;number.txt&quot;</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span> <span class="token comment">// io::Error è½¬æ¢ä¸º ParseIntError</span>
    <span class="token keyword">let</span> n<span class="token punctuation">:</span> <span class="token keyword">i32</span> <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
    <span class="token class-name">Ok</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="è¿ç®—ç¬¦ä¸-option"><a href="#è¿ç®—ç¬¦ä¸-option" class="header-anchor">#</a> ? è¿ç®—ç¬¦ä¸ Option</h3> <p><code>?</code> è¿ç®—ç¬¦ä¹Ÿå¯ä»¥ç”¨äº <code>Option</code> ç±»å‹ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">last_char_of_first_line</span><span class="token punctuation">(</span>text<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    text<span class="token punctuation">.</span><span class="token function">lines</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">last</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="ä½•æ—¶ä½¿ç”¨-panic"><a href="#ä½•æ—¶ä½¿ç”¨-panic" class="header-anchor">#</a> ä½•æ—¶ä½¿ç”¨ panic!</h2> <h3 id="ç¤ºä¾‹ã€ä»£ç åŸå‹å’Œæµ‹è¯•"><a href="#ç¤ºä¾‹ã€ä»£ç åŸå‹å’Œæµ‹è¯•" class="header-anchor">#</a> ç¤ºä¾‹ã€ä»£ç åŸå‹å’Œæµ‹è¯•</h3> <p>åœ¨ç¤ºä¾‹ä¸­ï¼Œ<code>unwrap</code> å’Œ <code>expect</code> æ–¹æ³•éå¸¸æœ‰ç”¨ï¼Œå®ƒä»¬åœ¨åŸå‹è®¾è®¡æ—¶éå¸¸æ˜ç¡®ï¼š</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>net<span class="token punctuation">::</span></span><span class="token class-name">IpAddr</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> home<span class="token punctuation">:</span> <span class="token class-name">IpAddr</span> <span class="token operator">=</span> <span class="token string">&quot;127.0.0.1&quot;</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="å½“ä½ æ¯”ç¼–è¯‘å™¨çŸ¥é“æ›´å¤šçš„æƒ…å†µ"><a href="#å½“ä½ æ¯”ç¼–è¯‘å™¨çŸ¥é“æ›´å¤šçš„æƒ…å†µ" class="header-anchor">#</a> å½“ä½ æ¯”ç¼–è¯‘å™¨çŸ¥é“æ›´å¤šçš„æƒ…å†µ</h3> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>net<span class="token punctuation">::</span></span><span class="token class-name">IpAddr</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> home<span class="token punctuation">:</span> <span class="token class-name">IpAddr</span> <span class="token operator">=</span> <span class="token string">&quot;127.0.0.1&quot;</span>
    <span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">&quot;Hardcoded IP address should be valid&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="æŒ‡å¯¼æ€§é”™è¯¯å¤„ç†"><a href="#æŒ‡å¯¼æ€§é”™è¯¯å¤„ç†" class="header-anchor">#</a> æŒ‡å¯¼æ€§é”™è¯¯å¤„ç†</h3> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">Guess</span> <span class="token punctuation">{</span>
    value<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token class-name">Guess</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">new</span><span class="token punctuation">(</span>value<span class="token punctuation">:</span> <span class="token keyword">i32</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Guess</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> value <span class="token operator">&lt;</span> <span class="token number">1</span> <span class="token operator">||</span> value <span class="token operator">&gt;</span> <span class="token number">100</span> <span class="token punctuation">{</span>
            <span class="token macro property">panic!</span><span class="token punctuation">(</span><span class="token string">&quot;Guess value must be between 1 and 100, got {}.&quot;</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">Guess</span> <span class="token punctuation">{</span>
            value
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">value</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token keyword">i32</span> <span class="token punctuation">{</span>
        <span class="token keyword">self</span><span class="token punctuation">.</span>value
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="åˆ›å»ºè‡ªå®šä¹‰é”™è¯¯ç±»å‹"><a href="#åˆ›å»ºè‡ªå®šä¹‰é”™è¯¯ç±»å‹" class="header-anchor">#</a> åˆ›å»ºè‡ªå®šä¹‰é”™è¯¯ç±»å‹</h2> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token attribute attr-name">#[derive(Debug)]</span>
<span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">MyError</span> <span class="token punctuation">{</span>
    <span class="token keyword">pub</span> message<span class="token punctuation">:</span> <span class="token class-name">String</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Display</span> <span class="token keyword">for</span> <span class="token class-name">MyError</span> <span class="token punctuation">{</span>
    <span class="token keyword">fn</span> <span class="token function-definition function">fmt</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> f<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Formatter</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token namespace">std<span class="token punctuation">::</span>fmt<span class="token punctuation">::</span></span><span class="token class-name">Result</span> <span class="token punctuation">{</span>
        <span class="token macro property">write!</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token string">&quot;MyError: {}&quot;</span><span class="token punctuation">,</span> <span class="token keyword">self</span><span class="token punctuation">.</span>message<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span> <span class="token namespace">std<span class="token punctuation">::</span>error<span class="token punctuation">::</span></span><span class="token class-name">Error</span> <span class="token keyword">for</span> <span class="token class-name">MyError</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">might_fail</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">MyError</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token class-name">Err</span><span class="token punctuation">(</span><span class="token class-name">MyError</span> <span class="token punctuation">{</span>
        message<span class="token punctuation">:</span> <span class="token string">&quot;Something went wrong&quot;</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="ä½¿ç”¨-anyhow-å’Œ-thiserror"><a href="#ä½¿ç”¨-anyhow-å’Œ-thiserror" class="header-anchor">#</a> ä½¿ç”¨ anyhow å’Œ thiserror</h2> <h3 id="anyhow-ç”¨äºåº”ç”¨ç¨‹åº"><a href="#anyhow-ç”¨äºåº”ç”¨ç¨‹åº" class="header-anchor">#</a> anyhow ç”¨äºåº”ç”¨ç¨‹åº</h3> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">use</span> <span class="token namespace">anyhow<span class="token punctuation">::</span></span><span class="token class-name">Result</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">read_and_parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Result</span><span class="token operator">&lt;</span><span class="token keyword">i32</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token namespace">std<span class="token punctuation">::</span>fs<span class="token punctuation">::</span></span><span class="token function">read_to_string</span><span class="token punctuation">(</span><span class="token string">&quot;number.txt&quot;</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> n<span class="token punctuation">:</span> <span class="token keyword">i32</span> <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">;</span>
    <span class="token class-name">Ok</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="thiserror-ç”¨äºåº“"><a href="#thiserror-ç”¨äºåº“" class="header-anchor">#</a> thiserror ç”¨äºåº“</h3> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">use</span> <span class="token namespace">thiserror<span class="token punctuation">::</span></span><span class="token class-name">Error</span><span class="token punctuation">;</span>

<span class="token attribute attr-name">#[derive(Error, Debug)]</span>
<span class="token keyword">pub</span> <span class="token keyword">enum</span> <span class="token type-definition class-name">MyError</span> <span class="token punctuation">{</span>
    <span class="token attribute attr-name">#[error(<span class="token string">&quot;IO error: {0}&quot;</span>)]</span>
    <span class="token class-name">Io</span><span class="token punctuation">(</span><span class="token attribute attr-name">#[from]</span> <span class="token namespace">std<span class="token punctuation">::</span>io<span class="token punctuation">::</span></span><span class="token class-name">Error</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    
    <span class="token attribute attr-name">#[error(<span class="token string">&quot;Parse error: {0}&quot;</span>)]</span>
    <span class="token class-name">Parse</span><span class="token punctuation">(</span><span class="token attribute attr-name">#[from]</span> <span class="token namespace">std<span class="token punctuation">::</span>num<span class="token punctuation">::</span></span><span class="token class-name">ParseIntError</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    
    <span class="token attribute attr-name">#[error(<span class="token string">&quot;Custom error: {message}&quot;</span>)]</span>
    <span class="token class-name">Custom</span> <span class="token punctuation">{</span> message<span class="token punctuation">:</span> <span class="token class-name">String</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="ğŸ’¡-å…³é”®è¦ç‚¹"><a href="#ğŸ’¡-å…³é”®è¦ç‚¹" class="header-anchor">#</a> ğŸ’¡ å…³é”®è¦ç‚¹</h2> <ol><li><strong>ä¸¤ç§é”™è¯¯ç±»å‹</strong>ï¼šå¯æ¢å¤çš„é”™è¯¯ç”¨ <code>Result</code>ï¼Œä¸å¯æ¢å¤çš„é”™è¯¯ç”¨ <code>panic!</code></li> <li><strong>? è¿ç®—ç¬¦å¾ˆå¼ºå¤§</strong>ï¼šç®€åŒ–é”™è¯¯ä¼ æ’­ï¼Œè‡ªåŠ¨è¿›è¡Œç±»å‹è½¬æ¢</li> <li><strong>é€‰æ‹©åˆé€‚çš„é”™è¯¯å¤„ç†æ–¹å¼</strong>ï¼šæ ¹æ®æƒ…å†µé€‰æ‹© <code>unwrap</code>ã€<code>expect</code> æˆ–å®Œæ•´çš„é”™è¯¯å¤„ç†</li> <li><strong>è‡ªå®šä¹‰é”™è¯¯ç±»å‹</strong>ï¼šä¸ºåº“ä»£ç åˆ›å»ºæœ‰æ„ä¹‰çš„é”™è¯¯ç±»å‹</li> <li><strong>é”™è¯¯ä¼ æ’­æ˜¯å¸¸è§æ¨¡å¼</strong>ï¼šè®©è°ƒç”¨è€…å†³å®šå¦‚ä½•å¤„ç†é”™è¯¯</li></ol> <h2 id="ğŸ¯-å®è·µå»ºè®®"><a href="#ğŸ¯-å®è·µå»ºè®®" class="header-anchor">#</a> ğŸ¯ å®è·µå»ºè®®</h2> <ol><li><strong>åº“ä»£ç è¿”å› Result</strong>ï¼šè®©è°ƒç”¨è€…å†³å®šå¦‚ä½•å¤„ç†é”™è¯¯</li> <li><strong>åº”ç”¨ç¨‹åºä»£ç å¯ä»¥ panic</strong>ï¼šåœ¨ç¡®å®šçš„é”™è¯¯æƒ…å†µä¸‹ä½¿ç”¨ <code>panic!</code></li> <li><strong>ä½¿ç”¨ expect è€Œä¸æ˜¯ unwrap</strong>ï¼šæä¾›æœ‰æ„ä¹‰çš„é”™è¯¯ä¿¡æ¯</li> <li><strong>è€ƒè™‘ä½¿ç”¨ anyhow æˆ– thiserror</strong>ï¼šç®€åŒ–é”™è¯¯å¤„ç†ä»£ç </li> <li><strong>åˆ›å»ºæœ‰æ„ä¹‰çš„é”™è¯¯ç±»å‹</strong>ï¼šå¸®åŠ©è°ƒç”¨è€…ç†è§£å’Œå¤„ç†é”™è¯¯</li></ol> <h2 id="ğŸ”—-ç›¸å…³é“¾æ¥"><a href="#ğŸ”—-ç›¸å…³é“¾æ¥" class="header-anchor">#</a> ğŸ”— ç›¸å…³é“¾æ¥</h2> <ul><li><strong>ä¸Šä¸€ç« </strong>: <a href="/matt-blog/pages/rust/collections.html">é›†åˆç±»å‹</a></li> <li><strong>ä¸‹ä¸€ç« </strong>: <a href="/matt-blog/pages/rust/generics-and-traits.html">æ³›å‹ä¸ç‰¹å¾</a></li> <li><strong>ç›¸å…³æ¦‚å¿µ</strong>: <a href="/matt-blog/pages/rust/data-structures.html">æ•°æ®ç»“æ„</a></li></ul> <hr> <p><a href="/matt-blog/pages/rust/" class="router-link-active">è¿”å›ç´¢å¼•</a></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/matt-blog/pages/rust/data-structures.html" class="prev">
        æ•°æ®ç»“æ„
      </a></span> <span class="next"><a href="/matt-blog/pages/rust/functional-programming.html">
        å‡½æ•°å¼ç¼–ç¨‹
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/matt-blog/assets/js/app.2eaa7660.js" defer></script><script src="/matt-blog/assets/js/2.778bb4ad.js" defer></script><script src="/matt-blog/assets/js/1.f8bb34da.js" defer></script><script src="/matt-blog/assets/js/43.10b4130b.js" defer></script>
  </body>
</html>
